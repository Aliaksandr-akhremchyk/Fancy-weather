(()=>{"use strict";var e={449:(e,t,o)=>{o.d(t,{X:()=>ve});const n=document.querySelector(".time"),l=document.querySelector(".day"),r=document.querySelector(".title-day-first"),c=document.querySelector(".title-day-second"),s=document.querySelector(".title-day-third");let a,i,u=0,d=!1,g="en";function m(e){a=e;let t=new Date;u=60*t.getTimezoneOffset(),t.setSeconds(t.getSeconds()+(e||0===e?e+u:0));let o=t.getHours(),l=t.getMinutes(),r=t.getSeconds();n.innerHTML=`${o}:${y(l)}:${y(r)}`,(o<6||o>=22)&&(d=!d),0===o&&0===l&&0===r&&p(),22===o&&0===l&&0===r&&le()}function y(e){return(parseInt(e,10)<10?"0":"")+e}function p(){let e=new Date;e.setSeconds(e.getSeconds()+(a?a+u:0));let t="ru"===g?0:1,o=[[["Воскресенье","Sunday"],["Вс","Sun"]],[["Понедельник","Monday"],["Пн","Mon"]],[["Вторник","Tuesday"],["Вт","Tue"]],[["Среда","Wednesday"],["Ср","Wed"]],[["Четверг","Thursday"],["Чт","Thu"]],[["Пятница","Friday"],["Пт","Fri"]],[["Суббота","Saturday"],["Сб","Sat"]]],n=e.getDay(),i=e.getDate(),d=e.getMonth();l.innerHTML=`${o[n][1][t]}, ${i} ${[["Января","January"],["Февраля","February"],["Марта","March"],["Апреля","April"],["Мая","May"],["Июня","June"],["Июля","July"],["Августа","August"],["Сентября","September"],["Октября","October"],["Ноября","November"],["Декабря","December"]][d][t]}`,e.setDate(e.getDate()+1),r.innerHTML=o[e.getDay()][0][t],e.setDate(e.getDate()+1),c.innerHTML=o[e.getDay()][0][t],e.setDate(e.getDate()+1),s.innerHTML=o[e.getDay()][0][t]}function h(e,t){return fetch(`https://api.climacell.co/v3/weather/forecast/daily?lat=${t}&lon=${e}&unit_system=si&start_time=now&fields=feels_like%2Ctemp%2Chumidity%2Cwind_speed%2Cweather_code&apikey=jvts28CAJvZln9V73cFjUSQCFtLnX2GT`).then((e=>e.json())).then((e=>{for(let t=0;t<4;++t)K.temp[t]=(e[t].temp[0].min.value+e[t].temp[1].max.value)/2,K.tempFeels[t]=(e[t].feels_like[0].min.value+e[t].feels_like[1].max.value)/2,K.wind[t]=(e[t].wind_speed[0].min.value+e[t].wind_speed[1].max.value)/2,K.humidity[t]=(e[t].humidity[0].min.value+e[t].humidity[1].max.value)/2,K.weatherCode[t]=e[t].weather_code.value;return console.log(e),"ok"})).catch((e=>console.log("не получилось с погодой")))}const f=document.querySelector(".message"),v=document.querySelector(".search-btn"),S=document.querySelector(".search-input");function w(){(function(e){let t="ru"===g?0:1;return console.log(t,g),fetch(`https://api.opencagedata.com/geocode/v1/json?q=${e}&key=75fa2f2d37824a27be34212ce12f3406&language=${g}`).then((e=>e.json())).then((e=>(console.log(e),K.place[t]=`${e.results[0].components.city||e.results[0].components.town||e.results[0].components.village||e.results[0].components["ISO_3166-1_alpha-3"]}, ${e.results[0].components.country}`,K.offset=e.results[0].annotations.timezone.offset_sec,K.lng=e.results[0].geometry.lng,K.lat=e.results[0].geometry.lat,[e.results[0].geometry.lng,e.results[0].geometry.lat]))).catch((e=>console.log("не получилось с кооординатами")))})(S.value).then((e=>(console.log("сюда дошли"),i.flyTo({center:[...e],essential:!0}),h(...e)))).then((e=>ee())).catch((e=>{console.log("не получилось ваще"),_(),setTimeout((()=>{f.classList.add("move")}),8e3)}))}function _(){f.classList.toggle("move")}v.addEventListener("click",w),S.addEventListener("keypress",(e=>{13!=e.which&&13!=e.keyCode||(w(),S.blur())})),S.addEventListener("focus",(()=>S.value="")),f.addEventListener("click",_);const q=document.querySelector(".t-search"),$=document.querySelector(".t-tempFeels"),L=document.querySelector(".t-wind"),C=document.querySelector(".d-wind"),b=document.querySelector(".t-humidity"),k=document.querySelector(".t-latitude"),x=document.querySelector(".t-longitude"),I=document.querySelector(".weatherCode"),z=document.querySelector(".city"),F=document.querySelector(".start-overlay");let M=[q,$,L,C,b,k,x,f,F],T=[["Поиск","Search"],["Ощущается: ","Feels like: "],["Ветер: ","Wind: "],["м/с","m/s"],["Влажность: ","Humidity: "],["Широта: ","Latitude: "],["Долгота: ","Longitude: "],["Что-то пошло не так...","Something went wrong..."],["Загрузка...","Loading..."]],j=["freezing_rain_heavy","freezing_rain","freezing_rain_light","freezing_drizzle","ice_pellets_heavy","ice_pellets","ice_pellets_light","snow_heavy","snow","snow_light","flurries","tstorm","rain_heavy","rain","rain_light","drizzle","fog_light","fog","cloudy","mostly_cloudy","partly_cloudy","mostly_clear","clear"],D=[["Сильный ледяной дождь","Heavy freezing rain"],["Ледяной дождь","Freezing rain"],["Легкий ледяной дождь","Light freezing rain"],["Ледяная изморось","Freezing drizzle"],["Сильный град","Heavy ice pellets"],["Град","Ice pellets"],["Лекгий град","Light ice pellets"],["Сильный снег","Heavy snow_heavy"],["Снег","Snow"],["Слабый снег","Light snow"],["Хрень","Flurries"],["Шторм","Tstorm"],["Сильный дождь","Heavy rain"],["Дождь","Rain"],["Легкий дождь","Light rain"],["Изморось","Drizzle"],["Легкий туман","Light fog"],["Туман","Fog"],["Сильная облачность","Cloudy"],["Значительная облачность","Mostly cloudy"],["Переменная облачность","Partly cloudy"],["Незначительная облачность","Mostly clear"],["Ясно","Clear"]];function H(){let e="ru"===g?0:1;for(let t=0;t<M.length;++t)M[t].textContent=T[t][e];E(K.weatherCode[0]),S.setAttribute("placeholder",e?"Сity or ZIP":"Город или Индекс"),z.textContent=K.place[e]}function E(e){let t="ru"===g?0:1;for(let o=0;o<j.length;++o)if(e==j[o])return void(I.textContent=D[o][t])}const O=document.querySelector(".temp"),A=document.querySelector(".temp-day-first"),J=document.querySelector(".temp-day-second"),P=document.querySelector(".temp-day-third"),R=document.querySelector(".tempFeels"),W=document.querySelector(".wind"),N=document.querySelector(".humidity"),Q=document.querySelector(".latitude"),X=document.querySelector(".longitude"),Z=document.querySelector(".icon-today"),V=document.querySelector(".icon-first"),Y=document.querySelector(".icon-second"),B=document.querySelector(".icon-third");let G=[O,A,J,P],U=[Z,V,Y,B],K={temp:[],tempFeels:[],wind:[],weatherCode:[],humidity:[],place:[],offset:0,lng:0,lat:0};function ee(){clearInterval(ve),m(K.offset),ve=setInterval(m,1e3,K.offset),p(),localStorage.setItem("search-city",S.value),oe(),le(),E(K.weatherCode[0]),W.textContent=K.wind[0].toFixed(1),N.textContent=`${Math.round(K.humidity[0])} %`,X.textContent=te(K.lng),Q.textContent=te(K.lat),function(e,t){let o="ru"===g?"en":"ru",n="ru"===o?0:1;fetch(`https://api.opencagedata.com/geocode/v1/json?q=${t}%2C%20${e}&key=75fa2f2d37824a27be34212ce12f3406&language=${o}`).then((e=>e.json())).then((e=>(K.place[n]=`${e.results[0].components.city||e.results[0].components.town||e.results[0].components.village||e.results[0].components["ISO_3166-1_alpha-3"]}, ${e.results[0].components.country}`,console.log(e),"ok"))).catch((e=>console.log("не получилось с Местом")))}(K.lng,K.lat),H(),F.style.display="none"}function te(e){return` ${(e=(e+="").split("."))[0]}°  ${e[1][0]+e[1][1]}'  ${e[1][2]+e[1][3]}" `}function oe(){for(let e=0;e<G.length;++e){let t=Math.round("°f"===ye?ne(K.temp[e]):K.temp[e]);G[e].textContent=`${t>0?"+":""}${t}`}let e=Math.round("°f"===ye?ne(K.tempFeels[0]):K.tempFeels[0]);R.textContent=`${e>0?"+":""}${e}`}function ne(e){return 1.8*e+32}function le(){let e="";d&&(e="-night");for(let t=0;t<U.length;++t)U[t].style.backgroundImage=`url(./src/assets/icons/${K.weatherCode[t]}${e}.svg)`}const re=document.querySelector(".background__img"),ce=document.querySelector(".header__refreshBtn"),se=document.querySelector(".inVector"),ae=document.querySelector(".leng-en"),ie=document.querySelector(".leng-ru"),ue=document.querySelector(".deg-f"),de=document.querySelector(".deg-c");let ge=180,me=!1,ye="°с";function pe(e){var t;e.target.classList.contains("passive")&&(g=e.target.textContent.toLowerCase(),t=g,localStorage.setItem("weather-leng",t),p(),H(),ae.classList.toggle("passive"),ie.classList.toggle("passive"))}function he(e){var t;e.target.classList.contains("passive")&&(ye=e.target.textContent.toLowerCase(),t=ye,localStorage.setItem("weather-deg",t),oe(),ue.classList.toggle("passive"),de.classList.toggle("passive"))}function fe(){re.style.opacity=me?"0":"1"}ue.addEventListener("click",he),de.addEventListener("click",he),ae.addEventListener("click",pe),ie.addEventListener("click",pe),ce.addEventListener("click",(()=>{se.style.transform=`rotate(${ge}deg)`,ge+=180,fetch("https://api.unsplash.com/photos/random?query=morning&client_id=e2077ad31a806c894c460aec8f81bc2af4d09c4f8104ae3177bb809faf0eac17").then((e=>e.json())).then((e=>function(e){const t=new Image;t.src=e,t.onload=()=>{me?(document.body.style.backgroundImage=`url(${t.src})`,fe(),me=!me):(re.style.backgroundImage=`url(${t.src})`,fe(),me=!me)}}(e.urls.regular)))})),m();let ve=setInterval(m,1e3);"°f"===localStorage.getItem("weather-deg")&&(ye="°f",ue.classList.toggle("passive"),de.classList.toggle("passive")),"ru"===localStorage.getItem("weather-leng")&&(g="ru",ae.classList.toggle("passive"),ie.classList.toggle("passive")),p(),mapboxgl.accessToken="pk.eyJ1IjoiYWxleDE5ODQwNSIsImEiOiJja2k4dzc2aTcwOXRmMzRtemFjN3ZjYWdpIn0.iu__APcp4HT_E4a1CHa6jQ",i=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[0,0],zoom:9.5}),0==localStorage.getItem("search-city")?navigator.geolocation.getCurrentPosition((function(e){var t=e.coords;K.lat=t.latitude,K.lng=t.longitude,console.log("Ваше текущее метоположение:"),console.log(`Широта: ${t.latitude}`),console.log(`Долгота: ${t.longitude}`),console.log(`Плюс-минус ${t.accuracy} метров.`),i.flyTo({center:[t.longitude,t.latitude],essential:!0}),function(e,t){let o="ru"===g?0:1;return fetch(`https://api.opencagedata.com/geocode/v1/json?q=${t}%2C%20${e}&key=75fa2f2d37824a27be34212ce12f3406&language=${g}`).then((e=>e.json())).then((e=>(K.place[o]=`${e.results[0].components.city||e.results[0].components.town||e.results[0].components.village||e.results[0].components["ISO_3166-1_alpha-3"]}, ${e.results[0].components.country}`,console.log(e),"ok"))).catch((e=>console.log("не получилось с Местом")))}(t.longitude,t.latitude).then((e=>h(t.longitude,t.latitude))).then((e=>ee()))}),(function(e){console.warn(`ERROR(${e.code}): ${e.message}`)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(S.value=localStorage.getItem("search-city"),w())}},t={};function o(n){if(t[n])return t[n].exports;var l=t[n]={exports:{}};return e[n](l,l.exports,o),l.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o(449)})();